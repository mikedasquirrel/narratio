<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UFC Betting Model | Narrative Optimization</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .betting-header {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            padding: 60px 20px;
            text-align: center;
            color: white;
        }
        
        .valid-badge {
            background: #4caf50;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin: 10px 0;
        }
        
        .invalid-badge {
            background: #f44336;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin: 10px 0;
        }
        
        .metric-box {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        
        .big-number {
            font-size: 64px;
            font-weight: bold;
            color: #ff9800;
            margin: 20px 0;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .comparison-table th {
            background: #f5f5f5;
            font-weight: bold;
            font-size: 14px;
            text-transform: uppercase;
        }
        
        .comparison-table tr.highlight {
            background: #fff3e0;
        }
    </style>
</head>
<body>
    <nav style="background: #1a1a1a; padding: 15px 20px;">
        <a href="/ufc" style="color: white; text-decoration: none;">‚Üê Back to UFC Dashboard</a>
    </nav>

    <div class="betting-header">
        <h1>üí∞ UFC Pre-Flight Betting Model</h1>
        <p style="font-size: 18px; margin-top: 10px;">
            Valid for Real Betting ‚Ä¢ Career Statistics Only ‚Ä¢ 11.5pp Edge
        </p>
        <span class="valid-badge">‚úì USES ONLY PRE-FIGHT DATA</span>
    </div>

    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 40px 20px;">
        
        {% if betting %}
        
        <!-- Key Metrics -->
        <div class="metric-box" style="text-align: center;">
            <h2>Betting Performance</h2>
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 30px;">
                <div>
                    <div class="big-number">{{ "%.1f"|format(betting.performance.full_model_auc * 100) }}%</div>
                    <div style="font-size: 18px; color: #666;">Prediction Accuracy</div>
                    <div style="font-size: 14px; color: #999; margin-top: 5px;">AUC Score</div>
                </div>
                <div>
                    <div class="big-number">+{{ "%.1f"|format(betting.betting.edge * 100) }}pp</div>
                    <div style="font-size: 18px; color: #666;">Betting Edge</div>
                    <div style="font-size: 14px; color: #999; margin-top: 5px;">vs Baseline (65.8%)</div>
                </div>
                <div>
                    <div class="big-number">+54.6%</div>
                    <div style="font-size: 18px; color: #666;">ROI</div>
                    <div style="font-size: 14px; color: #999; margin-top: 5px;">70% Confidence Bets</div>
                </div>
            </div>
        </div>

        <!-- Model Comparison -->
        <h2>Model Comparison: Post-Hoc vs Pre-Fight</h2>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Model Type</th>
                    <th>Data Used</th>
                    <th>Valid for Betting?</th>
                    <th>AUC</th>
                    <th>Purpose</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Post-Hoc Analysis</strong></td>
                    <td>Fight statistics (strikes, knockdowns, control)</td>
                    <td><span class="invalid-badge">‚úó NO</span></td>
                    <td>98.4%</td>
                    <td>Understand what determines outcomes</td>
                </tr>
                <tr class="highlight">
                    <td><strong>Pre-Flight Model</strong></td>
                    <td>Career stats (historical averages)</td>
                    <td><span class="valid-badge">‚úì YES</span></td>
                    <td>75.9%</td>
                    <td>Predict outcomes before fights</td>
                </tr>
            </tbody>
        </table>

        <!-- What Pre-Flight Model Uses -->
        <h2>Pre-Flight Features (All Known Before Fight)</h2>
        
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
            <div class="metric-box">
                <h3 style="margin-top: 0; color: #ff9800;">Career Performance (Historical)</h3>
                <ul style="line-height: 1.8;">
                    <li>SLpM: Strikes landed per minute (avg)</li>
                    <li>Str_Acc: Striking accuracy % (career)</li>
                    <li>TD_Avg: Takedown average (career)</li>
                    <li>TD_Acc: Takedown accuracy % (career)</li>
                    <li>Sub_Avg: Submission attempts (career)</li>
                    <li>Str_Def: Striking defense % (career)</li>
                    <li>TD_Def: Takedown defense % (career)</li>
                </ul>
            </div>
            
            <div class="metric-box">
                <h3 style="margin-top: 0; color: #ff9800;">Physical & Context</h3>
                <ul style="line-height: 1.8;">
                    <li>Reach: Fighter reach advantage</li>
                    <li>Stance: Orthodox vs Southpaw</li>
                    <li>Age: Fighter ages and gap</li>
                    <li>Names: Fighter names, nicknames</li>
                    <li>Title Fight: Championship bout flag</li>
                    <li>5 Rounds: Main event format</li>
                    <li>Weight Class: Division indicators</li>
                </ul>
            </div>
        </div>

        <!-- Betting Strategy Results -->
        <h2>Betting Strategy Performance</h2>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Strategy</th>
                    <th>Bets Placed</th>
                    <th>Accuracy</th>
                    <th>ROI</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Baseline (Always Favorite)</td>
                    <td>All fights</td>
                    <td>65.8%</td>
                    <td>0.0%</td>
                    <td>Break even</td>
                </tr>
                <tr>
                    <td>60% Confidence Threshold</td>
                    <td>1,134</td>
                    <td>74.5%</td>
                    <td>+49.0%</td>
                    <td>‚úì Profitable</td>
                </tr>
                <tr>
                    <td>65% Confidence Threshold</td>
                    <td>1,027</td>
                    <td>76.2%</td>
                    <td>+52.5%</td>
                    <td>‚úì Profitable</td>
                </tr>
                <tr class="highlight">
                    <td><strong>70% Confidence Threshold</strong></td>
                    <td><strong>921</strong></td>
                    <td><strong>77.3%</strong></td>
                    <td><strong>+54.6%</strong></td>
                    <td><strong>‚úì Highly Profitable</strong></td>
                </tr>
            </tbody>
        </table>

        <!-- Model Breakdown -->
        <h2>Model Component Contributions</h2>
        
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Component</th>
                    <th>AUC</th>
                    <th>Œî AUC</th>
                    <th>Interpretation</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Career Stats Only</td>
                    <td>71.9%</td>
                    <td>Baseline</td>
                    <td>Historical performance predicts future</td>
                </tr>
                <tr>
                    <td>+ Physical Attributes</td>
                    <td>76.1%</td>
                    <td>+4.2%</td>
                    <td>Reach, stance, age matter</td>
                </tr>
                <tr>
                    <td>+ Nominative & Context</td>
                    <td>75.9%</td>
                    <td>-0.2%</td>
                    <td>Names/context minor effect in pre-fight</td>
                </tr>
            </tbody>
        </table>

        <!-- Key Insights -->
        <div class="metric-box" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
            <h3 style="margin-top: 0;">Key Insights for Betting</h3>
            <ul style="line-height: 2;">
                <li><strong>Career performance predicts</strong>: 71.9% accuracy using historical stats alone</li>
                <li><strong>Physical attributes matter</strong>: +4.2% improvement from reach/stance/age</li>
                <li><strong>Selective betting works</strong>: 77.3% accuracy at 70% confidence (vs 65.8% baseline)</li>
                <li><strong>ROI potential</strong>: 54.6% return betting only high-confidence predictions</li>
                <li><strong>Coverage is good</strong>: Can predict 88.3% of fights (6,850/7,756)</li>
            </ul>
        </div>

        <!-- Limitations -->
        <div style="background: #fff; border: 2px solid #ddd; padding: 20px; margin: 30px 0; border-radius: 8px;">
            <h3 style="margin-top: 0;">Model Limitations</h3>
            <ul style="line-height: 1.8;">
                <li><strong>No real betting odds</strong>: Simulates even money, not actual Vegas lines</li>
                <li><strong>Historical backtesting</strong>: Not tested on truly future/unseen fights</li>
                <li><strong>Market efficiency</strong>: Real odds already incorporate much of this information</li>
                <li><strong>Narrative contribution small</strong>: -0.2% in pre-flight (context matters more in-fight)</li>
            </ul>
            <p style="margin-top: 15px; font-weight: bold;">
                Use as research/analysis tool. Real betting requires odds comparison and risk management.
            </p>
        </div>

        <!-- Links -->
        <div style="text-align: center; margin-top: 60px;">
            <a href="/ufc" class="button" style="background: #ff9800; color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; display: inline-block; margin: 10px;">
                Back to Dashboard
            </a>
            <a href="/ufc-results" class="button" style="background: #d50a0a; color: white; padding: 15px 30px; border-radius: 8px; text-decoration: none; display: inline-block; margin: 10px;">
                Context Analysis
            </a>
        </div>

        {% else %}
        <div style="background: #ffebee; padding: 30px; border-radius: 8px;">
            <h3>‚ö†Ô∏è Betting Model Not Available</h3>
            <p>Run <code>build_prefight_betting_model.py</code> to generate betting model.</p>
        </div>
        {% endif %}
    </div>
</body>
</html>

