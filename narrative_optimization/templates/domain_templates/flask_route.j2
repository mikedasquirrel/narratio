"""
{{ domain_name|title }} Domain Route

Flask route for {{ domain_name }} domain dashboard.
Auto-generated by onboarding wizard.
"""

from flask import Blueprint, render_template, jsonify
from pathlib import Path
import json
import sys

# Add project root to path
project_root = Path(__file__).parent.parent
sys.path.insert(0, str(project_root))

{{ domain_name }}_bp = Blueprint('{{ domain_name }}', __name__)


@{{ domain_name }}_bp.route('/{{ domain_name }}')
def {{ domain_name }}_dashboard():
    """{{ domain_name|title }} domain dashboard"""
    return render_template('{{ domain_name }}_dashboard.html')


@{{ domain_name }}_bp.route('/{{ domain_name }}-results')
def {{ domain_name }}_results():
    """{{ domain_name|title }} results page"""
    return render_template('{{ domain_name }}_results.html')


@{{ domain_name }}_bp.route('/api/{{ domain_name }}/results')
def {{ domain_name }}_results_api():
    """API endpoint for {{ domain_name }} results"""
    results_path = (
        project_root / 'narrative_optimization' / 'domains' / 
        '{{ domain_name }}' / '{{ domain_name }}_results.json'
    )
    
    if results_path.exists():
        with open(results_path, 'r') as f:
            results = json.load(f)
        return jsonify(results)
    else:
        return jsonify({'error': 'Results not found'}), 404


@{{ domain_name }}_bp.route('/api/{{ domain_name }}/config')
def {{ domain_name }}_config_api():
    """API endpoint for {{ domain_name }} configuration"""
    config_path = (
        project_root / 'narrative_optimization' / 'domains' / 
        '{{ domain_name }}' / 'config.yaml'
    )
    
    if config_path.exists():
        from src.pipelines.domain_config import DomainConfig
        config = DomainConfig.from_yaml(config_path)
        return jsonify(config.to_dict())
    else:
        return jsonify({'error': 'Config not found'}), 404

